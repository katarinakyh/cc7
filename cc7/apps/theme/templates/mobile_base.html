{% load i18n %}
{%load account_extras%}

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
    <script src="{{ STATIC_URL }}js/jquery-1.9.1.js" type="text/javascript" ></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJU7WLAtYAAwB4Q-4jYZ2uiktTvwt0aNU&sensor=false">
    </script>

    <script src="{{ STATIC_URL }}js/maps.js" type="text/javascript" ></script>
    <link rel="stylesheet" href="{{ STATIC_URL }}css/bootstrap_mobile.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}css/font-awesome.min.css">

    <script src="{{ STATIC_URL }}js/jquery-1.9.1.js" type="text/javascript" ></script>
    <script src="{{ STATIC_URL }}js/jquery.form.js"></script>
    <script src="{{ STATIC_URL }}js/adress.js" type="text/javascript" ></script>
    <script src="{{ STATIC_URL }}js/maps.js" type="text/javascript" ></script>
    <script src="{{ STATIC_URL }}js/adress.js" type="text/javascript" ></script>

    <style type="text/css">
        body {
            color: #333333;
            font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
            font-size: 14px;
            line-height: 20px;
        }

        a {
            color: #0088CC;
            text-decoration: none;
        }


        li {
            list-style-type: none;
        }

        .left_nav {
            float:left;
            padding-left: 5%;
            cursor: pointer;
        }


        .right_nav, .right_nav_details {
            float:right;
            padding-right: 5%;
            cursor: pointer;
        }

        .right_nav_details {
           font-weight: bold;
        }

        .center_nav {
            padding-left:8%;
            cursor: pointer;
        }
        .drop_nav {
            padding-left:  12%;
            cursor: pointer;
        }

        .search_nav {
            padding-left: 30%;
            cursor: pointer;
        }

        .menu {
            background: #111111;
            border: 1px solid #333333;
            color: #FFFFFF;
            font-weight: bold;
            text-shadow: 0 -1px 0 #000000;
        }

        .story, .story_detail,  {
            color: #555555;
            /*border-left: 5px solid #EEEEEE;*/
            margin-left: 4px;
            margin-top: 20px;
            padding-top: 2px;
            padding-bottom: 15px;
        }

        .post_content, .new_post {
            margin-left: 12px;
        }

        .comment_body {
            margin-left: 15px;
        }

        .story:hover {
            cursor: pointer;
        }

        .left_date {
            float:left;
            padding-left: 44px;

        }
        .right_date {
            float:right;
            padding-right: 44px;
            font-size: 10px;
        }

        .date_comment {
            background: #f3f3f3;
            margin-left: 4px;
            margin-right: 4px;
            padding-bottom: 20px;
            padding-left: 1px;
            font-size: 10px;
        }

        .postbody {
            margin-bottom: 20px;
            margin-left: 40px;
            margin-right: 10px;
            padding: 0 0 0 10px;

        }
        
        .mugshot {
            float: left;
            margin-right: 10px;
            margin-left: 14px;
            height: 30px;
            width: 30px;
        }

        #mugshot_detail {
            height: 20px;
            width: 20px;
        }

        .small {
            font-size: 10px;
        }

        .comment_body h3 {
            padding-top: 20px;
        }

        .comment_body form {
            padding-left: 5px;
        }

        .comment_body img {
            width: 20px;
            height: 20px;
        }

        .comment_text {
            margin-bottom: 20px;
            font-size: 10px;
            margin-right: 5px;

        }

        #add_local {
            cursor: pointer;
        }

        .current_location {
            font-size: 11px;
        }

        ul, ol {
            margin: 0 0 0px 0px;
            padding: 0;
        }

        div.hr_narrow {
            height: 2px;
            background: #fff;
            margin-left: 4px;
            margin-right: 4px;
        }
        .mobile_form {
            width: 300px;
            height: 160px;
        }
        .geolocation {
            width: 300px;
            margin-bottom: 10px;
            border: none;
        }
        .add_from_camera, .add_from_file, .add_location{
            font-size: 30px;
            cursor: pointer;
            width: 12px;
            height: 12px;
            margin-right: 45px;

        }
        .add_more{
            margin-bottom: 10px;
            margin-top: 10px;
        }
        .get_from_camera, .get_from_file{
            display: none;
        }
        .add_adress{
            display: none;
        }
        .icon-bullhorn {
            font-size: 21px;
            margin-right: -3px;
            color:#fff;
        }
        .thec{
            font-size: 36px;
            margin-right: -6px;
            
        }
        .header{
            
        }
        .btn-group{
            background-color: black;
            color: white;
        }
    </style>

    {% block extra_head %}{% endblock %}

    <title> {% block title %} {% trans "c7 social forum" %} {% endblock %} </title>

</head>
<body >
<script id="new_post_template" type="text/template">
    <div class="post_content">
        <h5>Share</h5>
        <div class="new_post">
            <form id="post_form" method="post" enctype="multipart/form-data"  >
                <label>A thought</label>
                <textarea id="new_post_body" class="mobile_form"></textarea><br />
                <div class="add_more">
                    <i class="icon-camera add_from_camera"></i>
                    <i class="icon-picture add_from_file"></i>
                    <span id="watchPositionBtn"><i class="icon-map-marker add_location"></i></span>
                    <button class="btn btn-primary" id="new_post">post</button>
                </div>

                <form>
                    <input  id="id_image" type="file" name="image" />
                    {% csrf_token %}
                    <input type="button" value="upload"
                           onClick="fileUpload(this.form,'/image/upload_file/','upload'); return false;" >
                    <div id="upload"></div>
                </form>

                <button id="submitImageForm">Submit</button>

                <div class="add_adress">
                    <label>Name this place</label>
                    <input id="place_name"   class="mobile_form" type="text">
                    <label>Address</label>
                    <input id="adress" class="mobile_form" type="text"><br />
                    <input id="latitude" class="mobile_form" type="hidden">
                    <input id="longitude" class="mobile_form" type="hidden">
                </div>
            </form>
            <div id="googleMap" style=" padding:1px; border:1px solid; height:400px; width:300px;"></div>
            <br>
        </div>
        <div id="map_canvas"> </div>

    </div>
</script>
    <div>
        <header class="menu">
                <span class="left_nav"><a href=""> <i class="icon-bullhorn"></i><span class="thec">c</span>7 </a></span>
               <span id="add_post" class="center_nav">
                   <a href="#add_post" >
                       <i class="icon-edit"></i><i class="icon-plus"></i>

                   </a>
               </span>
                <div class="btn-group">
                    <a class="" href="#"><i class="icon-list-alt"></i> All posts</a>
                    <a class="btn  dropdown-toggle" data-toggle="dropdown" href="#"><span class="icon-caret-down"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#"><i class="icon-group"></i> Hemliga</a></li>
                        <li><a href="#"><i class="icon-group"></i> Sparvnästet</a></li>
                        <li><a href="#"><i class="icon-group"></i> Kråkan</a></li>
                        <li class="divider"></li>
                        <li><a href="#"><i class="i"></i> <i class="icon-heart-empty"></i> Mina poster </a></li>
                    </ul>
                </div>
                <span class="right_nav">
                    <i class="icon-envelope icon-white"></i>(<a href="../messages/">1</a>)
                    <i class="icon-user icon-white"></i>
                </span>
            
        </header>

        <div id="post-data">
        </div>
    </div>
    <!-- template for list view -->
    <script id="post_list_template" type="text/template">
        <div class="story">
            <h6>
                <img class="mugshot" src="<%= mugshot %>" alt="Author"/>
                <a href="#detail_id?<%= id %>" > <%= title %> <span class="right_nav"> [<%= id %>]</span></a>
                    <span class="small">

                    </span>
            </h6>
            <div class="postbody">
                <%= body %>
            </div>
            <div class="date_comment">
                <span class="left_date"> Posted at: <%= date_created %></span>
                <span class="right_nav"> <a href="#detail_id?<%= id %>">Comment (<%= comment_count %>)</a></span>
            </div>
            <div class="hr_narrow"></div>
            <div class="date_comment">
                <span class="left_date"> Posted by:<strong><a href="/accounts/<%= author.user.username %>/"> <%= author.user.username %> </a></strong></span>
                <span class="right_nav_details"> <a href="#detail_id?<%= id %>">Details ></a></span>
            </div>
        </div>
        <span class="btn more_post" style="display:none;"></span>

    </script>
    <!-- template for list view -->
    <script id="single_post_template" type="text/template">
        <div class="story_detail">

                <img class="mugshot"  src="<%= mugshot %>" alt="Author"/>
                <h6><%= title %> </h6>
            <div class="postbody">
               - <%= body %>
            </div>
            <div class="date_comment">
                <span class="left_date"> Posted by:<a href="/accounts/<%= author.user.username %>/"> <%= author.user.username %> </a></span>
                <span class="right_nav"> Posted at: <%= date_created %></span>
            </div>

            <div class="comment_body">
                <h6><%= comment_count %> Comments</h6>
                <% _.each(comments, function(comment) { %>
            <div>
                <div class>
                    <span class="small"><a href="/accounts/<%= comment.author_name %>/"><%= comment.author_name %> </a> </span> <span class="right_date" ><%= comment.comment_date %></span>
                    <br/>
                </div>
               <div class="comment_text">
                  <span> <img id="mugshot_detail" src="<%= comment.author_mugshot %>" alt="Author"/> - <%= comment.comment_body %> </span>
                </div>f
            </div>
                <% }); %>
                <h6>Post a new Comment</h6>
                <form>
                    <textarea id="commentbody"></textarea><br />
                    <button class="newcomment">comment</button>
                </form>
            </div>
        </div>
    </script>
    <script type="text/javascript">

    </script>

    <script src="{{ STATIC_URL }}js/underscore.js"></script>
    <script src="{{ STATIC_URL }}js/backbone.js"></script>
    <script src="{{ STATIC_URL }}js/backbone-tastypie.js"></script>
    <script src="{{ STATIC_URL }}js/post.js"></script>
    <!--
    <script src="{{ STATIC_URL }}js/post.js"></script>
    <script src="{{ STATIC_URL }}js/models.js"></script>
    <script src="{{ STATIC_URL }}js/collections.js"></script>
    <script src="{{ STATIC_URL }}js/views.js"></script>
    <script src="{{ STATIC_URL }}js/router.js"></script>


    <script>
    
    new Posts.Router;
    // start listen form # change events in the url
    Backbone.history.start();
    </script>
    -->




<script language="javascript">
    function fileUpload(form, action_url, div_id) {
        // Create the iframe...
        var iframe = document.createElement("iframe");
        iframe.setAttribute("id", "upload_iframe");
        iframe.setAttribute("name", "upload_iframe");
        iframe.setAttribute("width", "0");
        iframe.setAttribute("height", "0");
        iframe.setAttribute("border", "0");
        iframe.setAttribute("style", "width: 0; height: 0; border: none;");

        // Add to document...
        form.parentNode.appendChild(iframe);
        window.frames['upload_iframe'].name = "upload_iframe";

        iframeId = document.getElementById("upload_iframe");

        // Add event...
        var eventHandler = function () {

            if (iframeId.detachEvent) iframeId.detachEvent("onload", eventHandler);
            else iframeId.removeEventListener("load", eventHandler, false);

            // Message from server...
            if (iframeId.contentDocument) {
                content = iframeId.contentDocument.body.innerHTML;
            } else if (iframeId.contentWindow) {
                content = iframeId.contentWindow.document.body.innerHTML;
            } else if (iframeId.document) {
                content = iframeId.document.body.innerHTML;
            }

            document.getElementById(div_id).innerHTML = content;

            // Del the iframe...
            setTimeout('iframeId.parentNode.removeChild(iframeId)', 250);
        }

        if (iframeId.addEventListener) iframeId.addEventListener("load", eventHandler, true);
        if (iframeId.attachEvent) iframeId.attachEvent("onload", eventHandler);

        // Set properties of form...
        form.setAttribute("target", "upload_iframe");
        form.setAttribute("action", action_url);
        form.setAttribute("method", "post");
        form.setAttribute("enctype", "multipart/form-data");
        form.setAttribute("encoding", "multipart/form-data");

        // Submit the form...
        form.submit();

        document.getElementById(div_id).innerHTML = "Uploading...";
    }
</script>

<!-- index.php could be any script server-side for receive uploads. -->

</body>
</html>
